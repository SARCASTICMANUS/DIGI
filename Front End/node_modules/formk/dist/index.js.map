{"version":3,"sources":["../src/index.js"],"names":["emptyObject","stateHook","useState","effectHook","useEffect","defaultClasses","form","field","invalid","valid","dirty","label","labelWrapper","contentWrapper","error","errorList","required","busy","input","defaultEvents","change","submit","reset","defaultComponents","help","defaultStyles","createProvider","options","autoValidateDelay","valueProp","classes","styles","components","events","formContext","useForm","Form","props","ref","parentForm","rerender","formRef","current","createForm","render","Field","fieldHelper","children","$field","id","Math","random","Date","getTime","toString","renderForm","defaultRenderForm","renderField","defaultRenderField","type","args","value","initialValue","onSubmit","onSuccess","onReset","onError","onChange","name","unhandledValue","setUnhandledValue","Object","assign","lastFields","fields","convertToArray","length","Error","key","namePathToString","getValue","mounted","Provider","comp","rules","autoValidate","labelProp","changeEvent","defaultValue","nextFieldProps","createField","handleSubmit","onSuccessOrEvent","preventDefault","validate","then","val","status","errors","updateField","nextValue","mutate","updateForm","handleReset","e","resetValidation","merge","unsetKeys","forEach","values","parent","entries","some","performValidation","obj","promiseFactory","undefined","promise","r","params","Promise","all","map","x","reduce","push","getFieldText","validator","Schema","rule","originalValidator","otherRuleProps","result","asyncValidator","_","callback","collectExtraInfo","res","message","Array","isArray","resolve","first","messages","suppressWarning","slice","path","join","part","$errors","Component","$props","handleChange","isEventObject","target","currentTarget","clearTimeout","setTimeout","resetEvent","submitEvent","noExtraAttrs","formProps","mergeProps","mergeClasses","className","native","defaultChangeEvent","InputComponent","LabelWrapper","ContentWrapper","Label","Help","ErrorList","fieldId","concat","fieldInput","style","mergeStyles","labelText","fieldProps","labelProps","labelContent","labelWrapperProps","hasError","errorListProps","errorListContent","index","contentWrapperProps","contentWrapperContent","Fragment","pair","filter","originalStyle","predefinedStyles","selectedStyles"],"mappings":"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","sourcesContent":["import {\n  createContext,\n  createElement,\n  forwardRef,\n  useContext,\n  useEffect,\n  useRef,\n  useState,\n  Fragment,\n} from \"react\";\nimport Schema from \"async-validator\";\n\nconst emptyObject = {};\nconst stateHook = useState;\nconst effectHook = useEffect;\nconst defaultClasses = {\n  form: \"formk-form\",\n  field: \"formk-field\",\n  invalid: \"formk-invalid\",\n  valid: \"formk-valid\",\n  dirty: \"formk-dirty\",\n  label: \"formk-label\",\n  labelWrapper: \"formk-label-wrapper\",\n  contentWrapper: \"formk-content-wrapper\",\n  error: \"formk-error\",\n  errorList: \"formk-error-list\",\n  required: \"formk-required\",\n  busy: \"formk-busy\",\n  input: \"formk-input\",\n};\nconst defaultEvents = {\n  change: \"onChange\",\n  submit: \"onSubmit\",\n  reset: \"onReset\",\n};\nconst defaultComponents = {\n  form: \"form\",\n  input: \"input\",\n  field: \"div\",\n  labelWrapper: \"div\",\n  contentWrapper: \"div\",\n  label: \"label\",\n  help: \"div\",\n  errorList: \"div\",\n  error: \"div\",\n};\nconst defaultStyles = emptyObject;\n\nconst createProvider = (options = {}) => {\n  options = {\n    // default options\n    autoValidateDelay: 200,\n    valueProp: \"value\",\n    ...options,\n    // shallow merged options\n    classes: {\n      ...defaultClasses,\n      ...options.classes,\n    },\n    styles: {\n      ...defaultStyles,\n      ...options.styles,\n    },\n    components: {\n      ...defaultComponents,\n      ...options.components,\n    },\n    events: {\n      ...defaultEvents,\n      ...options.events,\n    },\n  };\n  const formContext = createContext(null);\n  const useForm = () => (useContext(formContext) || {}).form;\n  const Form = forwardRef((props, ref) => {\n    const parentForm = useForm();\n    const [, rerender] = stateHook({});\n    const formRef = useRef();\n    // create form if not any\n    if (!formRef.current) {\n      formRef.current = createForm(parentForm, options);\n    }\n    useEffect(\n      () => () => {\n        formRef.current = null;\n      },\n      []\n    );\n    return formRef.current.render(\"form\", props, rerender, ref, formContext);\n  });\n\n  const Field = forwardRef((props, ref) => {\n    const parentForm = useForm();\n    const [, rerender] = stateHook(emptyObject);\n    if (!parentForm) return null;\n    return parentForm.render(\"field\", props, rerender, ref, formContext);\n  });\n\n  const fieldHelper = (props, children) => {\n    return createElement(Field, { ...props, children });\n  };\n\n  return { Form, Field, $field: fieldHelper, useForm };\n};\n\nconst createForm = (parentForm, options) => {\n  const id = \"f\" + (Math.random() * new Date().getTime()).toString(36);\n  const { renderForm = defaultRenderForm, renderField = defaultRenderField } =\n    options;\n\n  // render\n  const render = (type, args, rerender, ref, formContext) => {\n    if (type === \"form\") {\n      const {\n        value = emptyObject,\n        initialValue = emptyObject,\n        onSubmit,\n        onSuccess,\n        onReset,\n        onError,\n        onChange,\n        name,\n        children,\n        ...props\n      } = args;\n      const [unhandledValue, setUnhandledValue] = stateHook(initialValue);\n      Object.assign(form, {\n        lastFields: {\n          ...form.lastFields,\n          ...form.fields,\n        },\n        value: onChange ? value : unhandledValue,\n        initialValue,\n        name: convertToArray(name),\n        onSubmit,\n        onReset,\n        onSuccess,\n        onError,\n        onChange: onChange || setUnhandledValue,\n        fields: {},\n        rerender,\n        props,\n      });\n\n      if (form.name.length) {\n        if (!parentForm) {\n          throw new Error(\"No parent form found\");\n        }\n        const key = namePathToString(form.name);\n        const value = getValue(parentForm.value, form.name);\n        const initialValue = getValue(parentForm.initialValue, form.name);\n        Object.assign(form, {\n          value,\n          initialValue,\n        });\n        parentForm.fields[key] = form;\n      }\n\n      effectHook(() => {\n        form.mounted = true;\n        return () => {\n          form.mounted = false;\n        };\n      }, [form]);\n\n      if (ref) {\n        ref.current = form;\n      }\n      return createElement(\n        formContext.Provider,\n        { value: { form } },\n        renderForm(form, children, options)\n      );\n    }\n    if (type === \"field\") {\n      const {\n        name,\n        children,\n        label,\n        help,\n        comp,\n        rules,\n        autoValidate,\n        valueProp = options.valueProp,\n        labelProp = options.labelProp,\n        changeEvent,\n        defaultValue,\n        classes,\n        styles,\n        onChange,\n        ...props\n      } = args;\n      const nextFieldProps = {\n        name: convertToArray(name),\n        label,\n        help,\n        comp,\n        valueProp,\n        labelProp,\n        changeEvent,\n        classes,\n        styles,\n        rerender,\n        defaultValue,\n        autoValidate,\n        onChange,\n        rules: convertToArray(rules),\n      };\n      const key = namePathToString(nextFieldProps.name);\n      const field = form.lastFields[key] || createField(form, options);\n      const value = getValue(form.value, nextFieldProps.name);\n      const initialValue = getValue(form.initialValue, nextFieldProps.name);\n      form.fields[key] = field;\n      effectHook(() => {\n        field.mounted = true;\n        return () => {\n          field.mounted = false;\n        };\n      }, [field]);\n      Object.assign(field, nextFieldProps, {\n        value,\n        initialValue,\n        valueProp,\n        props,\n      });\n\n      if (ref) {\n        ref.current = field;\n      }\n\n      return renderField(field, children, options);\n    }\n  };\n  const handleSubmit = (onSuccessOrEvent, onError) => {\n    onSuccessOrEvent &&\n      onSuccessOrEvent.preventDefault &&\n      onSuccessOrEvent.preventDefault();\n    form.onSubmit && form.onSubmit(form.value, form);\n\n    return validate(form, options).then(() => {\n      if (form.val.status === \"valid\") {\n        typeof onSuccessOrEvent === \"function\" &&\n          onSuccessOrEvent(form.value, form);\n        form.onSuccess && form.onSuccess(form.value, form);\n      } else {\n        onError && onError(form.val.errors, form);\n        form.onError && form.onError(form.val.errors, form);\n      }\n    });\n  };\n\n  const updateField = (field, value) => {\n    const nextValue = mutate(form.value, field.name, value);\n    field.onChange && field.onChange(value, field);\n    updateForm(nextValue);\n  };\n\n  const updateForm = (value) => {\n    if (parentForm) {\n      parentForm.updateField(form, value);\n    } else {\n      form.onChange(value, form);\n    }\n    form.rerender({});\n  };\n\n  const handleReset = (e) => {\n    e && e.preventDefault && e.preventDefault();\n    typeof e === \"function\" && e(form);\n    reset();\n  };\n\n  const reset = () => {\n    form.onReset && form.onReset(form);\n    resetValidation(form);\n    updateForm(form.initialValue || emptyObject);\n  };\n\n  const merge = (value, ...unsetKeys) => {\n    const nextValue = { ...form.value, ...value };\n    unsetKeys.forEach((key) => delete nextValue[key]);\n    updateForm(nextValue);\n  };\n\n  const resetValidation = (form) => {\n    form.val = {\n      status: \"unknown\",\n      errors: [],\n    };\n    Object.values(form.fields).forEach((field) => {\n      if (field.fields) {\n        resetValidation(field);\n      } else {\n        field.val = {\n          status: \"unknown\",\n          errors: [],\n        };\n      }\n    });\n  };\n\n  const form = {\n    type: \"form\",\n    parent: parentForm,\n    id,\n    val: {\n      status: \"unknown\",\n      errors: [],\n    },\n    get dirty() {\n      return Object.entries(form.fields).some((field) => field.dirty);\n    },\n    render,\n    reset,\n    handleSubmit,\n    handleReset,\n    updateField,\n    updateForm,\n    merge,\n    fields: {},\n  };\n  return form;\n};\n\nconst performValidation = (obj, promiseFactory) => {\n  const val = {\n    value: obj.value,\n    fields: obj.fields,\n    status: \"busy\",\n    errors: [],\n    get error() {\n      return this.errors.length ? this.errors[0] : undefined;\n    },\n  };\n  obj.val = val;\n  const rerender = () => {\n    if (obj.val !== val) return;\n    obj.mounted && obj.rerender({});\n  };\n  val.promise = promiseFactory(val).then((errors) => {\n    val.errors = errors;\n    val.status = errors.length ? \"invalid\" : \"valid\";\n    rerender();\n  });\n\n  rerender();\n  return val.promise;\n};\n\nconst validate = (obj, options) => {\n  // if obj does not have any rule that requires values of other fields\n  // so we can skip validation if nothing changed since last time\n  if (obj.val && obj.val.value === obj.value) {\n    if (!obj.rules || !obj.rules.length || !obj.rules.some((r) => r.params)) {\n      return obj.val.promise;\n    }\n  }\n\n  // is form\n  if (obj.type === \"form\") {\n    return performValidation(obj, ({ fields }) =>\n      Promise.all(Object.values(fields).map((x) => validate(x, options))).then(\n        () =>\n          Object.values(fields).reduce((errors, field) => {\n            errors.push(...field.val.errors);\n            return errors;\n          }, [])\n      )\n    );\n  }\n\n  return performValidation(obj, () => {\n    const key = getFieldText(obj);\n    const validator = new Schema({\n      [key]: obj.rules.map((rule) => {\n        if (rule.validator) {\n          const { validator: originalValidator, ...otherRuleProps } = rule;\n          const result = { ...otherRuleProps };\n          if (originalValidator) {\n            result.asyncValidator = async (_, value, callback) => {\n              const { args, params } = collectExtraInfo(obj, rule, value);\n              const res = await originalValidator(...args, {\n                ...otherRuleProps,\n                params,\n                callback,\n              });\n              if (res === false) {\n                throw new Error(\n                  rule.message || `${getFieldText(obj)} is not valid`\n                );\n              }\n              if (res instanceof Error || Array.isArray(res)) throw res;\n            };\n          }\n\n          return result;\n        }\n        return rule;\n      }),\n    });\n    return new Promise((resolve) =>\n      validator\n        .validate(\n          {\n            [key]: obj.value,\n          },\n          {\n            first: true,\n            messages: options.messages,\n            suppressWarning: options.suppressWarning,\n          }\n        )\n        .then(\n          () => resolve([]),\n          ({ errors }) => resolve(errors)\n        )\n    );\n  });\n};\n\nconst getFieldText = (field) =>\n  field.label && typeof field.label !== \"function\"\n    ? field.label\n    : field.name.slice(-1)[0];\n\nconst collectExtraInfo = (field, rule, value) => {\n  const args = [value];\n  const params = {};\n  if (rule.params) {\n    // params is array, we push all selected field values to after value arg\n    if (Array.isArray(rule.params)) {\n      rule.params.forEach((path) =>\n        args.push(getValue(field.form.value, convertToArray(path)))\n      );\n    } else {\n      Object.entries(rule.params).forEach(([key, path]) => {\n        params[key] = getValue(field.form.value, convertToArray(path));\n      });\n    }\n  }\n  return { args, params };\n};\n\nconst convertToArray = (value) =>\n  typeof value === \"undefined\" || value === null\n    ? []\n    : Array.isArray(value)\n    ? value\n    : [value];\n\nconst namePathToString = (name) => convertToArray(name).join(\"_\");\n\nconst getValue = (obj, path) =>\n  path.reduce((value, part) => (value ? value[part] : undefined), obj);\n\nconst createField = (form, options) => {\n  const field = {\n    form,\n    type: \"field\",\n    val: {\n      status: \"unknown\",\n      errors: [],\n    },\n    get dirty() {\n      return field.value !== field.initialValue;\n    },\n    $errors(Component, props) {\n      return (\n        field.val.status === \"invalid\" &&\n        field.val.errors.map((error) =>\n          createElement(\n            Component,\n            typeof props === \"function\" ? props(error, field) : props,\n            error.message\n          )\n        )\n      );\n    },\n    $props(valueProp = \"value\", changeEvent = \"onChange\") {\n      return {\n        [valueProp]: field.value,\n        [changeEvent]: field.handleChange,\n      };\n    },\n    handleChange(e) {\n      const isEventObject =\n        e &&\n        typeof e === \"object\" &&\n        \"target\" in e &&\n        \"currentTarget\" in e &&\n        \"nativeEvent\" in e;\n      const value =\n        field.valueProp && isEventObject\n          ? (e.target || e.currentTarget || e)[field.valueProp]\n          : e;\n      form.updateField(field, value);\n      if (field.autoValidate) {\n        clearTimeout(field.autoValidateDelay);\n        field.autoValidateDelay = setTimeout(() => {\n          validate(field, options);\n        }, options.autoValidateDelay);\n      } else {\n        field.mounted && field.rerender({});\n      }\n    },\n  };\n  return field;\n};\n\nconst mutate = (obj, path, value) => {\n  if (Array.isArray(obj)) {\n    obj = [...obj];\n  } else {\n    obj = { ...obj };\n  }\n  obj[path[0]] =\n    path.length === 1 ? value : mutate(obj[path[0]], path.slice(1), value);\n  return obj;\n};\n\nconst defaultRenderForm = (\n  form,\n  children,\n  {\n    classes,\n    events: { reset: resetEvent, submit: submitEvent },\n    noExtraAttrs,\n    components: { form: Form },\n  }\n) => {\n  if (typeof children === \"function\") {\n    return children(form);\n  }\n  if (form.parent) {\n    return children;\n  }\n\n  if (!Form) return children;\n  const formProps = mergeProps(\n    form.props,\n    [\n      !noExtraAttrs && \"className\",\n      mergeClasses(\n        classes.form,\n        form.props.className,\n        classes[form.val.status],\n        ...(form.classes || [])\n      ),\n    ],\n    [resetEvent, form.handleReset],\n    [submitEvent, form.handleSubmit]\n  );\n  return createElement(Form, { ...formProps, children });\n};\n\nconst defaultRenderField = (\n  field,\n  children,\n  {\n    native,\n    classes,\n    styles,\n    noExtraAttrs,\n    events: { change: defaultChangeEvent },\n    components: {\n      input: InputComponent,\n      field: Field,\n      labelWrapper: LabelWrapper,\n      contentWrapper: ContentWrapper,\n      label: Label,\n      help: Help,\n      errorList: ErrorList,\n      error: Error,\n    },\n  }\n) => {\n  if (typeof children === \"function\") {\n    return children(field);\n  }\n\n  const {\n    form,\n    label,\n    help,\n    valueProp,\n    labelProp,\n    changeEvent = defaultChangeEvent,\n    name,\n    comp = InputComponent,\n    rules,\n    props,\n    val,\n    defaultValue,\n  } = field;\n  const fieldId = namePathToString([form.id].concat(name));\n  const fieldInput = createElement(\n    comp,\n    mergeProps(\n      props,\n      { children },\n      [!native && \"id\", fieldId],\n      [\n        valueProp,\n        typeof field.value === \"undefined\" ? defaultValue : field.value,\n      ],\n      [changeEvent, field.handleChange],\n      [\n        !noExtraAttrs && \"className\",\n        mergeClasses(classes.input, props.className, classes[field.val.status]),\n      ],\n      [\n        \"style\",\n        field.styles\n          ? { style: mergeStyles(props.style, styles, field.styles) }\n          : props.style,\n      ]\n    )\n  );\n\n  const required = rules.some((rule) => rule.required);\n  const labelText = typeof label === \"function\" ? label(field) : label;\n  const fieldProps = mergeProps(\n    [\n      !noExtraAttrs && \"className\",\n      mergeClasses(\n        classes.field,\n        required && classes.required,\n        val.status && classes[val.status],\n        ...(field.classes || [])\n      ),\n    ],\n    [typeof labelText !== \"undefined\" && labelProp, labelText]\n  );\n  const labelProps = mergeProps([!noExtraAttrs && \"htmlFor\", fieldId]);\n  const labelContent = !!Label && createElement(Label, labelProps, labelText);\n\n  const labelWrapperProps = mergeProps([\n    !noExtraAttrs && \"className\",\n    classes.labelWrapper,\n  ]);\n  const hasError = val.status === \"invalid\";\n  const errorListProps =\n    hasError && mergeProps([!noExtraAttrs && \"className\", classes.errorList]);\n  const errorListContent =\n    hasError &&\n    val.errors.map((error, index) =>\n      createElement(\n        Error,\n        {\n          key: index,\n          ...mergeProps([!noExtraAttrs && \"className\", classes.error]),\n        },\n        error.message\n      )\n    );\n  const contentWrapperProps = mergeProps([\n    !noExtraAttrs && \"className\",\n    classes.contentWrapper,\n  ]);\n  const contentWrapperContent = createElement(\n    Fragment,\n    {},\n    fieldInput,\n    help !== false &&\n      !!Help &&\n      createElement(\n        Help,\n        mergeProps([!noExtraAttrs && \"className\", classes.help]),\n        typeof help === \"function\" ? help(field) : help\n      ),\n    hasError &&\n      (ErrorList\n        ? createElement(ErrorList, errorListProps, errorListContent)\n        : errorListContent)\n  );\n\n  return createElement(\n    Field,\n    fieldProps,\n    label !== false &&\n      (LabelWrapper\n        ? createElement(LabelWrapper, labelWrapperProps, labelContent)\n        : labelContent),\n    ContentWrapper\n      ? createElement(\n          ContentWrapper,\n          contentWrapperProps,\n          contentWrapperContent\n        )\n      : contentWrapperContent\n  );\n};\n\nconst mergeProps = (...props) =>\n  props.reduce((obj, pair) => {\n    if (Array.isArray(pair)) {\n      const [name, value] = pair;\n      if (name) {\n        obj[name] = value;\n      }\n    } else {\n      Object.assign(obj, pair);\n    }\n    return obj;\n  }, {});\nconst mergeClasses = (...classes) => classes.filter((x) => !!x).join(\" \");\nconst mergeStyles = (originalStyle, predefinedStyles, selectedStyles) =>\n  Object.assign(\n    {},\n    originalStyle,\n    ...convertToArray(selectedStyles).map((x) => predefinedStyles[x])\n  );\n\nexport default createProvider;\n"],"file":"index.js"}